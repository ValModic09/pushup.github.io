<!DOCTYPE html>
  <html lang="sl">
   <head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>Napredek</title>
       <link rel="stylesheet" href="styles.css"> <!-- Povezava do istega CSS -->
       <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
   </head>
   <body>
       <h1>Napredeküí™</h1>
   
       <!-- Prikaz napredka -->
       <div id="progressStats">
           <h3>Napredek</h3>
           <p id="goalProgressText">üìà Napredek za ta teden: 0/0</p>
           <p id="allTimeStats">
               <strong>Skupno ≈°tevilo sklec: 0</strong><br>
               <strong>Povpreƒçje na dan: 0</strong><br>
               <strong>Najveƒçji set: 0</strong>
           </p>
       </div>
   <div id="streakDisplay"></div>
 
       <!-- Gumb za prenos napredka kot sliko -->
       <button id="downloadProgressBtn">Prenesi napredek kot sliko</button>

     <div id="ai-suggestion" style="margin-top:10px; font-weight: bold;"></div>

<button onclick="getAISuggestion()">Dobi AI nasvet</button>

   <!-- Gumb, ki deluje kot povezava na domaƒço stran -->
   <a href="index.html">
     <button class="home-btn">Nazaj na domaƒço stran</button>
   </a>



       <script src="progress.js"></script>
 <script>
    // Funkcija za pridobitev nasveta
    async function getAISuggestion() {
      const apiKey = 'TUKAJ_PRILEPI_SVOJ_API_KLJUƒå'; // Nadomesti z resniƒçnim API kljuƒçem

      // Preberemo podatke iz localStorage
      const exerciseData = JSON.parse(localStorage.getItem('exerciseData'));
      const weeklyGoal = JSON.parse(localStorage.getItem('weeklyGoal'));

      // Preverimo, ali so podatki prisotni
      if (!exerciseData || !weeklyGoal) {
        alert('Podatki niso na voljo v localStorage!');
        return;
      }

      const lastMaxPushups = exerciseData.lastMaxPushups || 0;
      const weeklyTotal = exerciseData.weeklyTotal || 0;

      // Oblikujemo prompt za OpenAI
      const prompt = `Uporabnik je zadnjiƒç naredil ${lastMaxPushups} sklec. 
      Skupno ta teden je naredil ${weeklyTotal} sklec. 
      Njegov tedenski cilj je ${weeklyGoal}. 
      Svetuj mu, kak≈°en naj bo njegov naslednji maksimum in tedenski cilj, v motivacijskem tonu.`;

      try {
        const response = await fetch('https://api.openai.com/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${apiKey}`
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [{ role: "user", content: prompt }]
          })
        });

        if (!response.ok) {
          throw new Error(`Napaka pri klicu API: ${response.statusText}`);
        }

        const data = await response.json();

        // Preverimo, ƒçe so podatki v odgovoru
        if (data.choices && data.choices[0] && data.choices[0].message && data.choices[0].message.content) {
          const aiText = data.choices[0].message.content;
          document.getElementById('ai-suggestion').innerText = aiText;
        } else {
          console.error('API odgovor ni v priƒçakovanem formatu');
        }
      } catch (error) {
        console.error('Napaka pri klicu API:', error);
      }
    }

    // Nastavimo zaƒçetne podatke v localStorage (po ≈æelji)
    const exerciseData = { lastMaxPushups: 25, weeklyTotal: 150 };
    const weeklyGoal = 200;
    localStorage.setItem('exerciseData', JSON.stringify(exerciseData));
    localStorage.setItem('weeklyGoal', JSON.stringify(weeklyGoal));
  </script>
   </body>

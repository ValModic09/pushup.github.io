<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikacija za ≈°tetje sklec</title>
    <link rel="stylesheet" href="styles.css">
    
</head>
<body>
   

    <h1 style="text-align: center;">Pozdravljena nazajüòä</h1>
    
    <div class="container">
        <h1>Skleceüí™</h1>
        <div id="streakDisplay"></div>

    

        <div class="exercise-input">
            <h2>Jutranje sklece</h2>
            <label for="setsMorning">≈†tevilo setov:</label>
            <input type="number" id="setsMorning" min="0" value="4">
            <label for="repsMorning">≈†tevilo ponovitev:</label>
            <input type="number" id="repsMorning" min="0" value="6">

            <h2>Veƒçerne sklece</h2>
            <label for="setsEvening">≈†tevilo setov:</label>
            <input type="number" id="setsEvening" min="0" value="5">
            <label for="repsEvening">≈†tevilo ponovitev:</label>
            <input type="number" id="repsEvening" min="0" value="5">
            <label for="maxSetEvening">Max set:</label>
            <input type="number" id="maxSetEvening" min="0" value="12">
        </div>
        <div class="buttons">
            <button class="other-button" onclick="addExercise()">Dodaj vadbo</button>
            <button class="odstrani" onclick="removeLastExercise()">Odstrani zadnji vnos</button>
        </div>
        <h3>üéØ Nastavi svoj tedenski cilj:</h3>
<input type="number" id="goalInput" placeholder="Npr. 300" />
<button class="statistika" onclick="saveGoal()">Shrani cilj</button>
<div id="goalProgressText">üìà Ta teden: 0/0 sklec (0%)</div>
        <div id="congratsMessage" style="color: green; font-weight: bold; margin-top: 10px;"></div>



        <div class="statistics">
            <p>Skupaj ponovitev: <span id="totalReps">0</span></p>
            <p>Povpreƒçje ponovitev na dan: <span id="averagePerDay">0.00</span></p>
        </div>
        <div class="chart-container">
            <canvas id="exerciseChart"></canvas>
        </div>
    </div>

    

    <script src="script.js"></script>

    <!-- Modal HTML -->
<div id="confirmModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <p>Ali res ≈æeli≈° izbrisati zadnji dana≈°nji vnos?</p>
        <button id="confirmBtn">Potrdi</button>
        <button onclick="closeModal()">Prekliƒçi</button>
    </div>
</div>

<style>
    /* Stil za modalno okno */
    .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        display: none;
        justify-content: center;
        align-items: center;
    }
    .modal-content {
        background-color: #242634;
        padding: 20px;
        border-radius: 5px;
        text-align: center;
    }
    .close {
        position: absolute;
        top: 10px;
        right: 10px;
        cursor: pointer;
    }
</style>

<a href="stats.html">

    <button class="statistika">Statistika</button>
</a>

 <!-- Gumb za prikaz nasveta -->
<button id="show-suggestion-btn">Nasvetüòä</button>

<!-- Modal (Pop-up) okno -->
<div id="suggestion-modal" class="modal">
  <div class="modal-content">
    <span id="close-modal" class="close">&times;</span>
    <p id="user-suggestion"></p>
  </div>
</div>

<!-- Element za prikaz nasveta -->
<p id="user-suggestion"></p>




    <button onclick="promptDeleteAllData()" class="odstrani">Izbri≈°i vse podatke</button>

<div id="deleteModal" class="modal">
    <div class="modal-content">
        <h2>Izbris vseh podatkov</h2>
        <p>Za izbris vseh podatkov vnesi kodo:</p>
        <input type="password" id="deleteCode" placeholder="Vnesi kodo">
        <button onclick="verifyDeleteAllData()">Potrdi</button>
        <button onclick="closeDeleteModal()">Prekliƒçi</button>
    </div>
</div>

    
<div id="motivational-popup" style="display: none;">
  <div class="popup-inner">
    <p id="motivational-text">Loading motivation... üí≠</p>
    <button id="close-popup-btn">Zapri üö™</button>
  </div>
</div>

 <script>
// Preveri, ƒçe so podatki pravilno nastavljeni
if (labels.length > 0 && totalRepsData.length > 0 && maxSetsData.length > 0) {
    const ctxExercise = document.getElementById('exerciseChart').getContext('2d');
    const exerciseChart = new Chart(ctxExercise, {
        type: 'line',
        data: {
            labels: labels, // Dnevi (datumi)
            datasets: [
                {
                    label: 'Sklece',
                    data: totalRepsData, // ≈†tevilo sklec
                    borderColor: 'rgba(75, 192, 192, 1)', // Barva za sklece
                    backgroundColor: 'rgba(75, 192, 192, 0.2)', // Osvetlitev
                    fill: true,
                    tension: 0.4, // Mehak krivulja
                    pointRadius: 5, // Velikost toƒçk
                    pointHoverRadius: 7, // Velikost toƒçk ob premiku mi≈°ke
                },
                {
                    label: 'Max',
                    data: maxSetsData, // Max seti
                    borderColor: 'rgba(255, 99, 132, 1)', // Barva za max
                    backgroundColor: 'rgba(255, 99, 132, 0.2)', // Osvetlitev
                    fill: false, // Ne izpolnjuj ozadja
                    tension: 0.4, // Mehak krivulja
                    pointRadius: 5, // Velikost toƒçk
                    pointHoverRadius: 7, // Velikost toƒçk ob premiku mi≈°ke
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: '#333', // Barva besedila v legendi
                        font: {
                            size: 14
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: '≈†tevilo sklec',
                        color: '#333', // Barva naslova osi Y
                        font: {
                            size: 14
                        }
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Datum',
                        color: '#333', // Barva naslova osi X
                        font: {
                            size: 14
                        }
                    }
                }
            }
        }
    });
} else {
    console.log('Podatki niso pravilno nastavljeni');
}

    </script>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Funkcija za izraƒçun zaƒçetka tedna (ponedeljek)
function getStartOfWeek(date) {
  const day = date.getDay(); // 0 = nedelja, 1 = ponedeljek, ...
  const diff = day === 0 ? -6 : 1 - day; // ƒåe je nedelja (0), se premaknemo nazaj za 6 dni, sicer za (1 - dan)
  const startOfWeek = new Date(date);
  startOfWeek.setDate(date.getDate() + diff); // Nastavimo datum na ponedeljek
  return startOfWeek;
}

// Funkcija za prikaz nasvetov
function displaySuggestion() {
  // Preverimo, ƒçe so podatki prisotni v localStorage
  const exerciseData = JSON.parse(localStorage.getItem('exerciseData'));
  const weeklyGoal = JSON.parse(localStorage.getItem('weeklyGoal'));

  // Preverimo, ƒçe so podatki prisotni
  if (!exerciseData || !weeklyGoal) {
    document.getElementById('user-suggestion').innerText = 'Podatki niso na voljo. üí°';
    return;
  }

  // Dobi trenutni datum
  const currentDate = new Date().toISOString().split('T')[0]; // Formatiramo datum kot 'YYYY-MM-DD'

  // Doloƒçimo zaƒçetek tedna (ponedeljek)
  const today = new Date();
  const startOfWeek = getStartOfWeek(today);
  const startOfWeekStr = startOfWeek.toISOString().split('T')[0]; // Datum zaƒçetka tedna v formatu 'YYYY-MM-DD'

  // Preverimo, ali imamo podatke za trenutni datum
  const currentData = exerciseData[currentDate];

  // ƒåe podatki za trenutni datum niso na voljo, preverimo od zaƒçetka tedna
  const dataToUse = currentData || exerciseData[startOfWeekStr];

  if (!dataToUse) {
    document.getElementById('user-suggestion').innerText = 'Podatki za danes in zaƒçetek tedna niso na voljo. üí°';
    return;
  }

  // Pridobimo podatke o zadnjem maksimalnem ≈°tevilu sklec (maxSets) in skupnem ≈°tevilu
  const lastMaxPushups = dataToUse.maxSets[dataToUse.maxSets.length - 1] || 0; // Zadnji maksimum
  const weeklyTotal = Object.values(exerciseData).reduce((total, data) => total + (data.totalReps || 0), 0); // Skupno ≈°tevilo sklec v tem tednu
  const maxCount = dataToUse.maxSets.filter(max => max === lastMaxPushups).length; // Kolikokrat je bil dose≈æen zadnji maksimum

  // Predlagamo poveƒçanje ≈°tevila sklec, ƒçe je uporabnikov maksimum dose≈æen veƒçkrat
  let suggestion = '';

  // Preverimo, koliko krat je bil dose≈æen trenutni maksimum
  if (maxCount >= 5) {  // ƒåe je bil maksimum dose≈æen 5-krat
    // Poveƒçamo maksimum
    const newMax = lastMaxPushups + 1;
    suggestion = `üëè Bravo, dosegla si ${lastMaxPushups} sklec ≈æe 5-krat! Zdaj je ƒças, da svojo moƒç dvigne≈° na ${newMax} sklec! üí™ Poka≈æi sebi, da zmore≈°! üòä`;

    // Posodobimo podatke v localStorage za nov maksimum
    dataToUse.maxSets.push(newMax); // Dodamo nov maksimum v seznam
    exerciseData[currentDate] = dataToUse; // Posodobimo podatke za trenutni datum
    localStorage.setItem('exerciseData', JSON.stringify(exerciseData));

  } else {
    // ƒåe trenutni maksimum ni dose≈æen dovoljkrat, svetujemo, da nadaljuje z njim
    suggestion = `Tvoj trenutni maksimum je ${lastMaxPushups} sklec. üéØ Poskusi doseƒçi ta maksimum ≈°e nekajkrat in kmalu bo≈° pripravljena na nov izziv! üí•`;
  }

  // Izraƒçunamo, koliko manjkajoƒçe ≈°tevilo sklec je do tedenskega cilja
  const remainingReps = weeklyGoal - weeklyTotal;
  if (remainingReps > 0) {
    suggestion += `\nüí™ Tvoj cilj (${weeklyGoal} sklec) je ≈°e pred teboj! Manjka ti ≈°e ${remainingReps} sklec, da dose≈æe≈° svoj cilj! Daj vse od sebe! üåü`;

    // Predlogi za dosego cilja
    suggestion += `\n\nüìà Kako doseƒçi cilj?\n1Ô∏è‚É£ Poskusi narediti eno skleco veƒç na vsakem setu, da poveƒça≈° napredek.\n2Ô∏è‚É£ Osredotoƒçi se na pravilno tehniko ‚Äì pomembno je, da sklece izvaja≈° pravilno, da se izogne≈° po≈°kodbam. üßò‚Äç‚ôÄÔ∏è\n3Ô∏è‚É£ Raje naredi veƒç setov z manj sklec, da bo≈° izbolj≈°ala vzdr≈æljivost in poƒçasi poveƒçala moƒç. üí™\n4Ô∏è‚É£ Verjamm vate, da ti lahko uspeüòä`;

  } else {
    // Predlagamo nov cilj, ƒçe je dose≈æen prej≈°nji cilj
    const newGoal = Math.round(weeklyGoal * 1.1);  // Poveƒçanje cilja za 10%
    suggestion += `\nüéâ Fantastiƒçno! Dosegla si svoj tedenski cilj (${weeklyGoal} sklec)! üèÜ\n\nTvoj novi cilj je: ${newGoal} sklec! üéØ Tvoja moƒç raste! Zdaj pa naredi naslednji korak! üí•`;

    // Posodobimo nov cilj v localStorage
    localStorage.setItem('weeklyGoal', JSON.stringify(newGoal));
  }

  // Prikaz nasveta v modalnem oknu
  document.getElementById('user-suggestion').innerText = suggestion;

  // Poka≈æemo modal
  document.getElementById('suggestion-modal').style.display = 'block';
}

// Povezujemo funkcijo s klikom na gumb
document.getElementById('show-suggestion-btn').addEventListener('click', displaySuggestion);

// Funkcija za zapiranje modala
document.getElementById('close-modal').addEventListener('click', () => {
  document.getElementById('suggestion-modal').style.display = 'none';
});

</script>
</body>
</html>
